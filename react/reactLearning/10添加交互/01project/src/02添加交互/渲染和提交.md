# 渲染和提交

1. *触发*一次渲染
2. *渲染*组件
3. *提交*到 DOM

## 步骤一：触发一次渲染

有两种原因会导致组价的渲染

1. 组件的初次渲染
2. 组件或者其祖先之一的 state 发生了改变（在 React 中如果没有特殊的处理，父组件重新渲染一定会导致子组件重新渲染）

### 初次渲染

启动应用的时候，会触发初次渲染，createRoot(dom).render(<App>)

### state 更新时重新渲染

初次渲染之后，可以通过调用 state setter 函数更新 state 来触发之后的渲染。更新组件的状态会自动*将一次渲染送入队列*

> 注意：并不是调用了 state setter 之后就马上开始渲染

## 步骤二：React 渲染你的组件

在触发渲染之后，React 会调用组件来确定要在屏幕上显示的内容
**渲染中就是 React 在调用组件**

- 在初次渲染的时候，React 会调用根组件
- 对于后续的渲染，React 会调用内部状态更新触发了渲染的函数组件

渲染必须始终是*纯计算*

- 输入相同，输出相同
- 只做自己的事情，不应该更改任何存在于渲染之前的对象或者变量

## 步骤三：React 把更改提交到 DOM 上

- 对于初次渲染，React 会调用 appendChild() 将创建的所有 DOM 节点放在屏幕上（注意会先清空目标容器 containerDOM.innerHTML = ''）
- 对于重新渲染，React 会应用最少得必要条件，以使得 DOM 于最新的渲染输出相互匹配

**React 仅在渲染之间存在差异的时候才会更改 DOM 节点。也就是说，父的重新渲染一定会触发子的重新渲染，但是不一定会将 DOM 替换掉，即使是一个组件内，也可能存在一部分的 DOM 更新了，一部分的 DOM 用的还是之前的**

[示例](https://zh-hans.react.dev/learn/render-and-commit#step-3-react-commits-changes-to-the-dom)

## 浏览器绘制

在渲染完成并且 React 更新完 DOM 之后，浏览器会重新绘制屏幕（浏览器渲染）
